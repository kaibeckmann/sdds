/*
 * AMN31112.c
 *
 *  Created on: 3 Jul 2012
 *      Author: k_beckma
 */


#include "AMN31112.h"
#include "driver.h"

#include <avr/io.h>

#define DRIVER_AMN31112_DDR INTERNAL_CONCAT(DDR, DRIVER_AMN31112_PORT)
#define DRIVER_AMN31112_PORTR INTERNAL_CONCAT(PORT, DRIVER_AMN31112_PORT)
#define DRIVER_AMN31112_PORTVAL INTERNAL_CONCAT(P, INTERNAL_CONCAT(DRIVER_AMN31112_PORT, DRIVER_AMN31112_PIN))
#define DRIVER_AMN31112_PINR INTERNAL_CONCAT(PIN, DRIVER_AMN31112_PORT)


rc_t AMN31112_init() {

	// set direction to input
	DRIVER_AMN31112_DDR &= ~_BV(DRIVER_AMN31112_PORTVAL);
	// deactivate pull up
	DRIVER_AMN31112_PORTR &= ~_BV(DRIVER_AMN31112_PORTVAL);

	return SDDS_RT_OK;
}

rc_t AMN31112_readMovement(bool_t* movement) {

	if (movement == NULL) {
		return SDDS_RT_BAD_PARAMETER;
	}

	*movement = (DRIVER_AMN31112_PINR & _BV(DRIVER_AMN31112_PORTVAL));

	return SDDS_RT_OK;
}
